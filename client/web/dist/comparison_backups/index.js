!function(){"use strict";var t="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function r(t,r){return t(r={exports:{}},r.exports),r.exports}var n,i=r(function(r,n){!function(r){function n(t){var r=arguments.length,n=void 0,i=void 0;for(n=1;n<r;n++)for(i in arguments[n])t[i]=arguments[n][i];return t}function i(t,r){var i,u,e=arguments.length,f=void 0;for(t.prototype=(i=r.prototype,(u=function(){}).prototype=i,new u),t.prototype.constructor=t,f=2;f<e;f++)n(t.prototype,arguments[f]);return t}var u=["<nothing>"],e="end",f="value",a="error",s="any";function h(t,r){var n=void 0,i=void 0,u=void 0,e=void 0;if(0===t.length)return r;if(0===r.length)return t;for(e=0,n=new Array(t.length+r.length),i=t.length,u=0;u<i;u++,e++)n[e]=t[u];for(i=r.length,u=0;u<i;u++,e++)n[e]=r[u];return n}function _(t,r){var n=t.length,i=void 0;for(i=0;i<n;i++)if(t[i]===r)return i;return-1}function c(t,r){var n=t.length,i=void 0;for(i=0;i<n;i++)if(r(t[i]))return i;return-1}function l(t){var r=t.length,n=new Array(r),i=void 0;for(i=0;i<r;i++)n[i]=t[i];return n}function m(t,r){var n=t.length,i=void 0,u=void 0,e=void 0;if(r>=0&&r<n){if(1===n)return[];for(i=new Array(n-1),u=0,e=0;u<n;u++)u!==r&&(i[e]=t[u],e++);return i}return t}function p(t,r){var n=t.length,i=new Array(n),u=void 0;for(u=0;u<n;u++)i[u]=r(t[u]);return i}function o(t,r,n){t===s?r(n):t===n.type&&(t===f||t===a?r(n.value):r())}function y(){this._items=[],this._spies=[],this._inLoop=0,this._removedItems=null}function w(){this._dispatcher=new y,this._active=!1,this._alive=!0,this._activating=!1,this._logHandlers=null,this._spyHandlers=null}function E(){w.call(this)}function A(){w.call(this),this._currentEvent=null}n(y.prototype,{add:function(t,r){return this._items=h(this._items,[{type:t,fn:r}]),this._items.length},remove:function(t,r){var n=c(this._items,function(n){return n.type===t&&n.fn===r});return 0!==this._inLoop&&-1!==n&&(null===this._removedItems&&(this._removedItems=[]),this._removedItems.push(this._items[n])),this._items=m(this._items,n),this._items.length},addSpy:function(t){return this._spies=h(this._spies,[t]),this._spies.length},removeSpy:function(t){return this._spies=m(this._spies,this._spies.indexOf(t)),this._spies.length},dispatch:function(t){this._inLoop++;for(var r=0,n=this._spies;null!==this._spies&&r<n.length;r++)n[r](t);for(var i=0,u=this._items;i<u.length&&null!==this._items;i++)null!==this._removedItems&&(e=this._removedItems,f=u[i],-1!==_(e,f))||o(u[i].type,u[i].fn,t);var e,f;this._inLoop--,0===this._inLoop&&(this._removedItems=null)},cleanup:function(){this._items=null,this._spies=null}}),n(w.prototype,{_name:"observable",_onActivation:function(){},_onDeactivation:function(){},_setActive:function(t){this._active!==t&&(this._active=t,t?(this._activating=!0,this._onActivation(),this._activating=!1):this._onDeactivation())},_clear:function(){this._setActive(!1),this._dispatcher.cleanup(),this._dispatcher=null,this._logHandlers=null},_emit:function(t,r){switch(t){case f:return this._emitValue(r);case a:return this._emitError(r);case e:return this._emitEnd()}},_emitValue:function(t){this._alive&&this._dispatcher.dispatch({type:f,value:t})},_emitError:function(t){this._alive&&this._dispatcher.dispatch({type:a,value:t})},_emitEnd:function(){this._alive&&(this._alive=!1,this._dispatcher.dispatch({type:e}),this._clear())},_on:function(t,r){return this._alive?(this._dispatcher.add(t,r),this._setActive(!0)):o(t,r,{type:e}),this},_off:function(t,r){if(this._alive){var n=this._dispatcher.remove(t,r);0===n&&this._setActive(!1)}return this},onValue:function(t){return this._on(f,t)},onError:function(t){return this._on(a,t)},onEnd:function(t){return this._on(e,t)},onAny:function(t){return this._on(s,t)},offValue:function(t){return this._off(f,t)},offError:function(t){return this._off(a,t)},offEnd:function(t){return this._off(e,t)},offAny:function(t){return this._off(s,t)},observe:function(t,r,n){var i=this,u=!1,s=t&&"function"!=typeof t?t:{value:t,error:r,end:n},h=function(t){t.type===e&&(u=!0),t.type===f&&s.value?s.value(t.value):t.type===a&&s.error?s.error(t.value):t.type===e&&s.end&&s.end(t.value)};return this.onAny(h),{unsubscribe:function(){u||(i.offAny(h),u=!0)},get closed(){return u}}},_ofSameType:function(t,r){return t.prototype.getType()===this.getType()?t:r},setName:function(t,r){return this._name=r?t._name+"."+r:t,this},log:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString(),r=void 0,n=function(n){var i="<"+n.type+(r?":current":"")+">";n.type===e?console.log(t,i):console.log(t,i,n.value)};return this._alive&&(this._logHandlers||(this._logHandlers=[]),this._logHandlers.push({name:t,handler:n})),r=!0,this.onAny(n),r=!1,this},offLog:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString();if(this._logHandlers){var r=c(this._logHandlers,function(r){return r.name===t});-1!==r&&(this.offAny(this._logHandlers[r].handler),this._logHandlers.splice(r,1))}return this},spy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString(),r=function(r){var n="<"+r.type+">";r.type===e?console.log(t,n):console.log(t,n,r.value)};return this._alive&&(this._spyHandlers||(this._spyHandlers=[]),this._spyHandlers.push({name:t,handler:r}),this._dispatcher.addSpy(r)),this},offSpy:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.toString();if(this._spyHandlers){var r=c(this._spyHandlers,function(r){return r.name===t});-1!==r&&(this._dispatcher.removeSpy(this._spyHandlers[r].handler),this._spyHandlers.splice(r,1))}return this}}),w.prototype.toString=function(){return"["+this._name+"]"},i(E,w,{_name:"stream",getType:function(){return"stream"}}),i(A,w,{_name:"property",_emitValue:function(t){this._alive&&(this._currentEvent={type:f,value:t},this._activating||this._dispatcher.dispatch({type:f,value:t}))},_emitError:function(t){this._alive&&(this._currentEvent={type:a,value:t},this._activating||this._dispatcher.dispatch({type:a,value:t}))},_emitEnd:function(){this._alive&&(this._alive=!1,this._activating||this._dispatcher.dispatch({type:e}),this._clear())},_on:function(t,r){return this._alive&&(this._dispatcher.add(t,r),this._setActive(!0)),null!==this._currentEvent&&o(t,r,this._currentEvent),this._alive||o(t,r,{type:e}),this},getType:function(){return"property"}});var v=new E;function T(){return v}function O(t){function r(t,r){var n=this;E.call(this),this._wait=t,this._intervalId=null,this._$onTick=function(){return n._onTick()},this._init(r)}return i(r,E,{_init:function(){},_free:function(){},_onTick:function(){},_onActivation:function(){this._intervalId=setInterval(this._$onTick,this._wait)},_onDeactivation:function(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null)},_clear:function(){E.prototype._clear.call(this),this._$onTick=null,this._free()}},t),r}v._emitEnd(),v._name="never";var V=O({_name:"later",_init:function(t){var r=t.x;this._x=r},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x),this._emitEnd()}});function C(t,r){return new V(t,{x:r})}var $=O({_name:"interval",_init:function(t){var r=t.x;this._x=r},_free:function(){this._x=null},_onTick:function(){this._emitValue(this._x)}});function P(t,r){return new $(t,{x:r})}var j=O({_name:"sequentially",_init:function(t){var r=t.xs;this._xs=l(r)},_free:function(){this._xs=null},_onTick:function(){1===this._xs.length?(this._emitValue(this._xs[0]),this._emitEnd()):this._emitValue(this._xs.shift())}});function I(t,r){return 0===r.length?T():new j(t,{xs:r})}var D=O({_name:"fromPoll",_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_onTick:function(){var t=this._fn;this._emitValue(t())}});function g(t,r){return new D(t,{fn:r})}function b(t){function r(r){return t._emitValue(r),t._active}function n(r){return t._emit(r.type,r.value),t._active}return{value:r,error:function(r){return t._emitError(r),t._active},end:function(){return t._emitEnd(),t._active},event:n,emit:r,emitEvent:n}}var H=O({_name:"withInterval",_init:function(t){var r=t.fn;this._fn=r,this._emitter=b(this)},_free:function(){this._fn=null,this._emitter=null},_onTick:function(){var t=this._fn;t(this._emitter)}});function q(t,r){return new H(t,{fn:r})}function M(t){E.call(this),this._fn=t,this._unsubscribe=null}function B(t){return new M(t)}function W(t){var r=!1;return B(function(n){r||(t(function(t){n.emit(t),n.end()}),r=!0)}).setName("fromCallback")}function L(t){var r=!1;return B(function(n){r||(t(function(t,r){t?n.error(t):n.emit(r),n.end()}),r=!0)}).setName("fromNodeCallback")}function G(t,r){switch(r){case 0:return function(){return t()};case 1:return function(r){return t(r[0])};case 2:return function(r){return t(r[0],r[1])};case 3:return function(r){return t(r[0],r[1],r[2])};case 4:return function(r){return t(r[0],r[1],r[2],r[3])};default:return function(r){return t.apply(null,r)}}}i(M,E,{_name:"stream",_onActivation:function(){var t=this._fn,r=t(b(this));this._unsubscribe="function"==typeof r?r:null,this._active||this._callUnsubscribe()},_callUnsubscribe:function(){null!==this._unsubscribe&&(this._unsubscribe(),this._unsubscribe=null)},_onDeactivation:function(){this._callUnsubscribe()},_clear:function(){E.prototype._clear.call(this),this._fn=null}});var Q=[["addEventListener","removeEventListener"],["addListener","removeListener"],["on","off"]];function X(t,r,n){for(var i=void 0,u=void 0,e=0;e<Q.length;e++)if("function"==typeof t[Q[e][0]]&&"function"==typeof t[Q[e][1]]){i=Q[e][0],u=Q[e][1];break}if(void 0===i)throw new Error("target don't support any of addEventListener/removeEventListener, addListener/removeListener, on/off method pair");return function(t,r,n){return B(function(i){var u=n?function(){i.emit(function(t,r,n){var i=n?n.length:0;if(null==r)switch(i){case 0:return t();case 1:return t(n[0]);case 2:return t(n[0],n[1]);case 3:return t(n[0],n[1],n[2]);case 4:return t(n[0],n[1],n[2],n[3]);default:return t.apply(null,n)}else switch(i){case 0:return t.call(r);default:return t.apply(r,n)}}(n,this,arguments))}:function(t){i.emit(t)};return t(u),function(){return r(u)}}).setName("fromSubUnsub")}(function(n){return t[i](r,n)},function(n){return t[u](r,n)},n).setName("fromEvents")}function J(t){this._currentEvent={type:"value",value:t,current:!0}}function U(t){return new J(t)}function Y(t){this._currentEvent={type:"error",value:t,current:!0}}function K(t){return new Y(t)}function z(t,r){return function(n,i){var u=this;t.call(this),this._source=n,this._name=n._name+"."+r,this._init(i),this._$handleAny=function(t){return u._handleAny(t)}}}function Z(t){return{_init:function(){},_free:function(){},_handleValue:function(t){this._emitValue(t)},_handleError:function(t){this._emitError(t)},_handleEnd:function(){this._emitEnd()},_handleAny:function(t){switch(t.type){case f:return this._handleValue(t.value);case a:return this._handleError(t.value);case e:return this._handleEnd()}},_onActivation:function(){this._source.onAny(this._$handleAny)},_onDeactivation:function(){this._source.offAny(this._$handleAny)},_clear:function(){t.prototype._clear.call(this),this._source=null,this._$handleAny=null,this._free()}}}function R(t,r){var n=z(E,t);return i(n,E,Z(E),r),n}function F(t,r){var n=z(A,t);return i(n,A,Z(A),r),n}i(J,A,{_name:"constant",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null}),i(Y,A,{_name:"constantError",_active:!1,_activating:!1,_alive:!1,_dispatcher:null,_logHandlers:null});var S=F("toProperty",{_init:function(t){var r=t.fn;this._getInitialCurrent=r},_onActivation:function(){if(null!==this._getInitialCurrent){var t=this._getInitialCurrent;this._emitValue(t())}this._source.onAny(this._$handleAny)}});function N(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(null!==r&&"function"!=typeof r)throw new Error("You should call toProperty() with a function or no arguments.");return new S(t,{fn:r})}var x=R("changes",{_handleValue:function(t){this._activating||this._emitValue(t)},_handleError:function(t){this._activating||this._emitError(t)}});function k(t){var r=!1,n=B(function(n){if(!r){var i=t.then(function(t){n.emit(t),n.end()},function(t){n.error(t),n.end()});i&&"function"==typeof i.done&&i.done(),r=!0}});return N(n,null).setName("fromPromise")}function d(){if("function"==typeof Promise)return Promise;throw new Error("There isn't default Promise, use shim or parameter")}var tt="undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{};function rt(t,r){return t(r={exports:{}},r.exports),r.exports}var nt=rt(function(t,r){Object.defineProperty(r,"__esModule",{value:!0}),r.default=function(t){var r,n=t.Symbol;return"function"==typeof n?n.observable?r=n.observable:(r=n("observable"),n.observable=r):r="@@observable",r}}),it=rt(function(t,r){Object.defineProperty(r,"__esModule",{value:!0});var n,i,u=(n=nt)&&n.__esModule?n:{default:n};i="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==tt?tt:t;var e=(0,u.default)(i);r.default=e}),ut=it.default?it.default:it;function et(t){var r=t[ut]?t[ut]():t;return B(function(t){var n=r.subscribe({error:function(r){t.error(r),t.end()},next:function(r){t.emit(r)},complete:function(){t.end()}});return n.unsubscribe?function(){n.unsubscribe()}:n}).setName("fromESObservable")}function ft(t){this._observable=t.takeErrors(1)}function at(){return new ft(this)}function st(t,r,n){for(var i in t)t.hasOwnProperty(i)&&(r.push(i),n.push(t[i]))}function ht(t,r,n){var i=this;E.call(this),this._activeCount=t.length,this._sources=h(t,r),this._combinator=n,this._aliveCount=0,this._latestValues=new Array(this._sources.length),this._latestErrors=new Array(this._sources.length),function(t,r){var n=t.length,i=void 0;for(i=0;i<n;i++)t[i]=r}(this._latestValues,u),this._emitAfterActivation=!1,this._endAfterActivation=!1,this._latestErrorIndex=0,this._$handlers=[];for(var e=function(t){i._$handlers.push(function(r){return i._handleAny(t,r)})},f=0;f<this._sources.length;f++)e(f)}function _t(t,r,n){return"function"==typeof r&&(n=r,r=void 0),Array.isArray(t)?function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments[2];if(!Array.isArray(r))throw new Error("Combine can only combine active and passive collections of the same type.");return n=n?G(n,t.length+r.length):function(t){return t},0===t.length?T():new ht(t,r,n)}(t,r,n):function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments[2];if("object"!=typeof r||Array.isArray(r))throw new Error("Combine can only combine active and passive collections of the same type.");var i=[],u=[],e=[];return st(t,i,u),st(r,i,e),0===u.length?T():new ht(u,e,function(t){for(var r={},u=t.length-1;0<=u;u--)r[i[u]]=t[u];return n?n(r):r})}(t,r,n)}n(ft.prototype,{subscribe:function(t,r,n){var i=this,u="function"==typeof t?{next:t,error:r,complete:n}:t,s=function(t){t.type===e&&(h=!0),t.type===f&&u.next?u.next(t.value):t.type===a&&u.error?u.error(t.value):t.type===e&&u.complete&&u.complete(t.value)};this._observable.onAny(s);var h=!1,_={unsubscribe:function(){h=!0,i._observable.offAny(s)},get closed(){return h}};return _}}),ft.prototype[ut]=function(){return this},i(ht,E,{_name:"combine",_onActivation:function(){this._aliveCount=this._activeCount;for(var t=this._activeCount;t<this._sources.length;t++)this._sources[t].onAny(this._$handlers[t]);for(var r=0;r<this._activeCount;r++)this._sources[r].onAny(this._$handlers[r]);this._emitAfterActivation&&(this._emitAfterActivation=!1,this._emitIfFull()),this._endAfterActivation&&this._emitEnd()},_onDeactivation:function(){var t=this._sources.length,r=void 0;for(r=0;r<t;r++)this._sources[r].offAny(this._$handlers[r])},_emitIfFull:function(){for(var t=!0,r=!1,n=this._latestValues.length,i=new Array(n),e=new Array(n),f=0;f<n;f++)i[f]=this._latestValues[f],e[f]=this._latestErrors[f],i[f]===u&&(t=!1),void 0!==e[f]&&(r=!0);if(t){var a=this._combinator;this._emitValue(a(i))}r&&this._emitError(function(t){for(var r=void 0,n=0;n<t.length;n++)void 0!==t[n]&&(void 0===r||r.index<t[n].index)&&(r=t[n]);return r.error}(e))},_handleAny:function(t,r){r.type===f||r.type===a?(r.type===f&&(this._latestValues[t]=r.value,this._latestErrors[t]=void 0),r.type===a&&(this._latestValues[t]=u,this._latestErrors[t]={index:this._latestErrorIndex++,error:r.value}),t<this._activeCount&&(this._activating?this._emitAfterActivation=!0:this._emitIfFull())):t<this._activeCount&&(this._aliveCount--,0===this._aliveCount&&(this._activating?this._endAfterActivation=!0:this._emitEnd()))},_clear:function(){E.prototype._clear.call(this),this._sources=null,this._latestValues=null,this._latestErrors=null,this._combinator=null,this._$handlers=null}});var ct={empty:function(){return T()},concat:function(t,r){return t.merge(r)},of:function(t){return U(t)},map:function(t,r){return r.map(t)},bimap:function(t,r,n){return n.mapErrors(t).map(r)},ap:function(t,r){return _t([t,r],function(t,r){return t(r)})},chain:function(t,r){return r.flatMap(t)}},lt=Object.freeze({Observable:ct}),mt={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){var r=this._fn;this._emitValue(r(t))}},pt=R("map",mt),ot=F("map",mt),yt=function(t){return t};function wt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:yt;return new(t._ofSameType(pt,ot))(t,{fn:r})}var Et={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){var r=this._fn;r(t)&&this._emitValue(t)}},At=R("filter",Et),vt=F("filter",Et),Tt=function(t){return t},Ot={_init:function(t){var r=t.n;this._n=r,r<=0&&this._emitEnd()},_handleValue:function(t){0!==this._n&&(this._n--,this._emitValue(t),0===this._n&&this._emitEnd())}},Vt=R("take",Ot),Ct=F("take",Ot),$t={_init:function(t){var r=t.n;this._n=r,r<=0&&this._emitEnd()},_handleError:function(t){0!==this._n&&(this._n--,this._emitError(t),0===this._n&&this._emitEnd())}},Pt=R("takeErrors",$t),jt=F("takeErrors",$t),It={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){var r=this._fn;r(t)?this._emitValue(t):this._emitEnd()}},Dt=R("takeWhile",It),gt=F("takeWhile",It),bt=function(t){return t},Ht={_init:function(){this._lastValue=u},_free:function(){this._lastValue=null},_handleValue:function(t){this._lastValue=t},_handleEnd:function(){this._lastValue!==u&&this._emitValue(this._lastValue),this._emitEnd()}},qt=R("last",Ht),Mt=F("last",Ht),Bt={_init:function(t){var r=t.n;this._n=Math.max(0,r)},_handleValue:function(t){0===this._n?this._emitValue(t):this._n--}},Wt=R("skip",Bt),Lt=F("skip",Bt),Gt={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){var r=this._fn;null===this._fn||r(t)||(this._fn=null),null===this._fn&&this._emitValue(t)}},Qt=R("skipWhile",Gt),Xt=F("skipWhile",Gt),Jt=function(t){return t},Ut={_init:function(t){var r=t.fn;this._fn=r,this._prev=u},_free:function(){this._fn=null,this._prev=null},_handleValue:function(t){var r=this._fn;this._prev!==u&&r(this._prev,t)||(this._prev=t,this._emitValue(t))}},Yt=R("skipDuplicates",Ut),Kt=F("skipDuplicates",Ut),zt=function(t,r){return t===r};function Zt(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:zt;return new(t._ofSameType(Yt,Kt))(t,{fn:r})}var Rt={_init:function(t){var r=t.fn,n=t.seed;this._fn=r,this._prev=n},_free:function(){this._prev=null,this._fn=null},_handleValue:function(t){if(this._prev!==u){var r=this._fn;this._emitValue(r(this._prev,t))}this._prev=t}},Ft=R("diff",Rt),St=F("diff",Rt);function Nt(t,r){return[t,r]}var xt=F("scan",{_init:function(t){var r=t.fn,n=t.seed;this._fn=r,this._seed=n,n!==u&&this._emitValue(n)},_free:function(){this._fn=null,this._seed=null},_handleValue:function(t){var r=this._fn;null===this._currentEvent||this._currentEvent.type===a?this._emitValue(this._seed===u?t:r(this._seed,t)):this._emitValue(r(this._currentEvent.value,t))}}),kt=R("flatten",{_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){for(var r=this._fn,n=r(t),i=0;i<n.length;i++)this._emitValue(n[i])}}),dt=function(t){return t},tr={},rr={_init:function(t){var r=this,n=t.wait;this._wait=Math.max(0,n),this._buff=[],this._$shiftBuff=function(){var t=r._buff.shift();t===tr?r._emitEnd():r._emitValue(t)}},_free:function(){this._buff=null,this._$shiftBuff=null},_handleValue:function(t){this._activating?this._emitValue(t):(this._buff.push(t),setTimeout(this._$shiftBuff,this._wait))},_handleEnd:function(){this._activating?this._emitEnd():(this._buff.push(tr),setTimeout(this._$shiftBuff,this._wait))}},nr=R("delay",rr),ir=F("delay",rr),ur=Date.now?function(){return Date.now()}:function(){return(new Date).getTime()},er={_init:function(t){var r=this,n=t.wait,i=t.leading,u=t.trailing;this._wait=Math.max(0,n),this._leading=i,this._trailing=u,this._trailingValue=null,this._timeoutId=null,this._endLater=!1,this._lastCallTime=0,this._$trailingCall=function(){return r._trailingCall()}},_free:function(){this._trailingValue=null,this._$trailingCall=null},_handleValue:function(t){if(this._activating)this._emitValue(t);else{var r=ur();0!==this._lastCallTime||this._leading||(this._lastCallTime=r);var n=this._wait-(r-this._lastCallTime);n<=0?(this._cancelTrailing(),this._lastCallTime=r,this._emitValue(t)):this._trailing&&(this._cancelTrailing(),this._trailingValue=t,this._timeoutId=setTimeout(this._$trailingCall,n))}},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId?this._endLater=!0:this._emitEnd()},_cancelTrailing:function(){null!==this._timeoutId&&(clearTimeout(this._timeoutId),this._timeoutId=null)},_trailingCall:function(){this._emitValue(this._trailingValue),this._timeoutId=null,this._trailingValue=null,this._lastCallTime=this._leading?ur():0,this._endLater&&this._emitEnd()}},fr=R("throttle",er),ar=F("throttle",er),sr={_init:function(t){var r=this,n=t.wait,i=t.immediate;this._wait=Math.max(0,n),this._immediate=i,this._lastAttempt=0,this._timeoutId=null,this._laterValue=null,this._endLater=!1,this._$later=function(){return r._later()}},_free:function(){this._laterValue=null,this._$later=null},_handleValue:function(t){this._activating?this._emitValue(t):(this._lastAttempt=ur(),this._immediate&&!this._timeoutId&&this._emitValue(t),this._timeoutId||(this._timeoutId=setTimeout(this._$later,this._wait)),this._immediate||(this._laterValue=t))},_handleEnd:function(){this._activating?this._emitEnd():this._timeoutId&&!this._immediate?this._endLater=!0:this._emitEnd()},_later:function(){var t=ur()-this._lastAttempt;t<this._wait&&t>=0?this._timeoutId=setTimeout(this._$later,this._wait-t):(this._timeoutId=null,this._immediate||(this._emitValue(this._laterValue),this._laterValue=null),this._endLater&&this._emitEnd())}},hr=R("debounce",sr),_r=F("debounce",sr),cr={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleError:function(t){var r=this._fn;this._emitError(r(t))}},lr=R("mapErrors",cr),mr=F("mapErrors",cr),pr=function(t){return t},or={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleError:function(t){var r=this._fn;r(t)&&this._emitError(t)}},yr=R("filterErrors",or),wr=F("filterErrors",or),Er=function(t){return t},Ar={_handleValue:function(){}},vr=R("ignoreValues",Ar),Tr=F("ignoreValues",Ar),Or={_handleError:function(){}},Vr=R("ignoreErrors",Or),Cr=F("ignoreErrors",Or),$r={_handleEnd:function(){}},Pr=R("ignoreEnd",$r),jr=F("ignoreEnd",$r),Ir={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleEnd:function(){var t=this._fn;this._emitValue(t()),this._emitEnd()}},Dr=R("beforeEnd",Ir),gr=F("beforeEnd",Ir),br={_init:function(t){var r=t.min,n=t.max;this._max=n,this._min=r,this._buff=[]},_free:function(){this._buff=null},_handleValue:function(t){this._buff=function(t,r,n){var i=Math.min(n,t.length+1),u=t.length-i+1,e=new Array(i),f=void 0;for(f=u;f<i;f++)e[f-u]=t[f];return e[i-1]=r,e}(this._buff,t,this._max),this._buff.length>=this._min&&this._emitValue(this._buff)}},Hr=R("slidingWindow",br),qr=F("slidingWindow",br),Mr={_init:function(t){var r=t.fn,n=t.flushOnEnd;this._fn=r,this._flushOnEnd=n,this._buff=[]},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t);var r=this._fn;r(t)||this._flush()},_handleEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()}},Br=R("bufferWhile",Mr),Wr=F("bufferWhile",Mr),Lr=function(t){return t},Gr={_init:function(t){var r=t.count,n=t.flushOnEnd;this._count=r,this._flushOnEnd=n,this._buff=[]},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&0!==this._buff.length&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),this._buff.length>=this._count&&this._flush()},_handleEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()}},Qr=R("bufferWithCount",Gr),Xr=F("bufferWithCount",Gr),Jr={_init:function(t){var r=this,n=t.wait,i=t.count,u=t.flushOnEnd;this._wait=n,this._count=i,this._flushOnEnd=u,this._intervalId=null,this._$onTick=function(){return r._flush()},this._buff=[]},_free:function(){this._$onTick=null,this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handleValue:function(t){this._buff.push(t),this._buff.length>=this._count&&(clearInterval(this._intervalId),this._flush(),this._intervalId=setInterval(this._$onTick,this._wait))},_handleEnd:function(){this._flushOnEnd&&0!==this._buff.length&&this._flush(),this._emitEnd()},_onActivation:function(){this._intervalId=setInterval(this._$onTick,this._wait),this._source.onAny(this._$handleAny)},_onDeactivation:function(){null!==this._intervalId&&(clearInterval(this._intervalId),this._intervalId=null),this._source.offAny(this._$handleAny)}},Ur=R("bufferWithTimeOrCount",Jr),Yr=F("bufferWithTimeOrCount",Jr),Kr={_init:function(t){var r,n=t.transducer;this._xform=n((r=this,{"@@transducer/step":function(t,n){return r._emitValue(n),null},"@@transducer/result":function(){return r._emitEnd(),null}}))},_free:function(){this._xform=null},_handleValue:function(t){null!==this._xform["@@transducer/step"](null,t)&&this._xform["@@transducer/result"](null)},_handleEnd:function(){this._xform["@@transducer/result"](null)}},zr=R("transduce",Kr),Zr=F("transduce",Kr),Rr={_init:function(t){var r=t.fn;this._handler=r,this._emitter=b(this)},_free:function(){this._handler=null,this._emitter=null},_handleAny:function(t){this._handler(this._emitter,t)}},Fr=R("withHandler",Rr),Sr=F("withHandler",Rr),Nr=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)};function xr(t,r){var n=this;E.call(this),this._buffers=p(t,function(t){return Nr(t)?l(t):[]}),this._sources=p(t,function(t){return Nr(t)?T():t}),this._combinator=r?G(r,this._sources.length):function(t){return t},this._aliveCount=0,this._$handlers=[];for(var i=function(t){n._$handlers.push(function(r){return n._handleAny(t,r)})},u=0;u<this._sources.length;u++)i(u)}function kr(t,r){return 0===t.length?T():new xr(t,r)}i(xr,E,{_name:"zip",_onActivation:function(){for(;this._isFull();)this._emit();var t=this._sources.length;this._aliveCount=t;for(var r=0;r<t&&this._active;r++)this._sources[r].onAny(this._$handlers[r])},_onDeactivation:function(){for(var t=0;t<this._sources.length;t++)this._sources[t].offAny(this._$handlers[t])},_emit:function(){for(var t=new Array(this._buffers.length),r=0;r<this._buffers.length;r++)t[r]=this._buffers[r].shift();var n=this._combinator;this._emitValue(n(t))},_isFull:function(){for(var t=0;t<this._buffers.length;t++)if(0===this._buffers[t].length)return!1;return!0},_handleAny:function(t,r){r.type===f&&(this._buffers[t].push(r.value),this._isFull()&&this._emit()),r.type===a&&this._emitError(r.value),r.type===e&&(this._aliveCount--,0===this._aliveCount&&this._emitEnd())},_clear:function(){E.prototype._clear.call(this),this._sources=null,this._buffers=null,this._combinator=null,this._$handlers=null}});var dr=function(t){return t};function tn(){var t=this,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=r.queueLim,i=void 0===n?0:n,u=r.concurLim,e=void 0===u?-1:u,f=r.drop,a=void 0===f?"new":f;E.call(this),this._queueLim=i<0?-1:i,this._concurLim=e<0?-1:e,this._drop=a,this._queue=[],this._curSources=[],this._$handleSubAny=function(r){return t._handleSubAny(r)},this._$endHandlers=[],this._currentlyAdding=null,0===this._concurLim&&this._emitEnd()}function rn(t){tn.call(this),this._addAll(t),this._initialised=!0}function nn(t){return 0===t.length?T():new rn(t)}function un(t){var r=this;E.call(this),this._generator=t,this._source=null,this._inLoop=!1,this._iteration=0,this._$handleAny=function(t){return r._handleAny(t)}}i(tn,E,{_name:"abstractPool",_add:function(t,r){r=r||dr,-1===this._concurLim||this._curSources.length<this._concurLim?this._addToCur(r(t)):-1===this._queueLim||this._queue.length<this._queueLim?this._addToQueue(r(t)):"old"===this._drop&&(this._removeOldest(),this._add(t,r))},_addAll:function(t){var r=this;!function(t,r){var n=t.length,i=void 0;for(i=0;i<n;i++)r(t[i])}(t,function(t){return r._add(t)})},_remove:function(t){-1===this._removeCur(t)&&this._removeQueue(t)},_addToQueue:function(t){this._queue=h(this._queue,[t])},_addToCur:function(t){if(this._active){if(!t._alive)return t._currentEvent&&this._emit(t._currentEvent.type,t._currentEvent.value),void(this._active&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()));this._currentlyAdding=t,t.onAny(this._$handleSubAny),this._currentlyAdding=null,t._alive&&(this._curSources=h(this._curSources,[t]),this._active&&this._subToEnd(t))}else this._curSources=h(this._curSources,[t])},_subToEnd:function(t){var r=this,n=function(){return r._removeCur(t)};this._$endHandlers.push({obs:t,handler:n}),t.onEnd(n)},_subscribe:function(t){t.onAny(this._$handleSubAny),this._active&&this._subToEnd(t)},_unsubscribe:function(t){t.offAny(this._$handleSubAny);var r=c(this._$endHandlers,function(r){return r.obs===t});-1!==r&&(t.offEnd(this._$endHandlers[r].handler),this._$endHandlers.splice(r,1))},_handleSubAny:function(t){t.type===f?this._emitValue(t.value):t.type===a&&this._emitError(t.value)},_removeQueue:function(t){var r=_(this._queue,t);return this._queue=m(this._queue,r),r},_removeCur:function(t){this._active&&this._unsubscribe(t);var r=_(this._curSources,t);return this._curSources=m(this._curSources,r),-1!==r&&(0!==this._queue.length?this._pullQueue():0===this._curSources.length&&this._onEmpty()),r},_removeOldest:function(){this._removeCur(this._curSources[0])},_pullQueue:function(){0!==this._queue.length&&(this._queue=l(this._queue),this._addToCur(this._queue.shift()))},_onActivation:function(){for(var t=0,r=this._curSources;t<r.length&&this._active;t++)this._subscribe(r[t])},_onDeactivation:function(){for(var t=0,r=this._curSources;t<r.length;t++)this._unsubscribe(r[t]);null!==this._currentlyAdding&&this._unsubscribe(this._currentlyAdding)},_isEmpty:function(){return 0===this._curSources.length},_onEmpty:function(){},_clear:function(){E.prototype._clear.call(this),this._queue=null,this._curSources=null,this._$handleSubAny=null,this._$endHandlers=null}}),i(rn,tn,{_name:"merge",_onEmpty:function(){this._initialised&&this._emitEnd()}}),i(un,E,{_name:"repeat",_handleAny:function(t){t.type===e?(this._source=null,this._getSource()):this._emit(t.type,t.value)},_getSource:function(){if(!this._inLoop){this._inLoop=!0;for(var t=this._generator;null===this._source&&this._alive&&this._active;)this._source=t(this._iteration++),this._source?this._source.onAny(this._$handleAny):this._emitEnd();this._inLoop=!1}},_onActivation:function(){this._source?this._source.onAny(this._$handleAny):this._getSource()},_onDeactivation:function(){this._source&&this._source.offAny(this._$handleAny)},_clear:function(){E.prototype._clear.call(this),this._generator=null,this._source=null,this._$handleAny=null}});var en=function(t){return new un(t)};function fn(t){return en(function(r){return t.length>r&&t[r]}).setName("concat")}function an(){tn.call(this)}function sn(t,r,n){var i=this;tn.call(this,n),this._source=t,this._fn=r,this._mainEnded=!1,this._lastCurrent=null,this._$handleMain=function(t){return i._handleMain(t)}}function hn(t,r){sn.call(this,t,r)}function _n(t,r){return function(n,i,e){var f=this;t.call(this),this._primary=n,this._secondary=i,this._name=n._name+"."+r,this._lastSecondary=u,this._$handleSecondaryAny=function(t){return f._handleSecondaryAny(t)},this._$handlePrimaryAny=function(t){return f._handlePrimaryAny(t)},this._init(e)}}function cn(t){return{_init:function(){},_free:function(){},_handlePrimaryValue:function(t){this._emitValue(t)},_handlePrimaryError:function(t){this._emitError(t)},_handlePrimaryEnd:function(){this._emitEnd()},_handleSecondaryValue:function(t){this._lastSecondary=t},_handleSecondaryError:function(t){this._emitError(t)},_handleSecondaryEnd:function(){},_handlePrimaryAny:function(t){switch(t.type){case f:return this._handlePrimaryValue(t.value);case a:return this._handlePrimaryError(t.value);case e:return this._handlePrimaryEnd(t.value)}},_handleSecondaryAny:function(t){switch(t.type){case f:return this._handleSecondaryValue(t.value);case a:return this._handleSecondaryError(t.value);case e:this._handleSecondaryEnd(t.value),this._removeSecondary()}},_removeSecondary:function(){null!==this._secondary&&(this._secondary.offAny(this._$handleSecondaryAny),this._$handleSecondaryAny=null,this._secondary=null)},_onActivation:function(){null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny),this._active&&this._primary.onAny(this._$handlePrimaryAny)},_onDeactivation:function(){null!==this._secondary&&this._secondary.offAny(this._$handleSecondaryAny),this._primary.offAny(this._$handlePrimaryAny)},_clear:function(){t.prototype._clear.call(this),this._primary=null,this._secondary=null,this._lastSecondary=null,this._$handleSecondaryAny=null,this._$handlePrimaryAny=null,this._free()}}}function ln(t,r){var n=_n(E,t);return i(n,E,cn(E),r),n}function mn(t,r){var n=_n(A,t);return i(n,A,cn(A),r),n}i(an,tn,{_name:"pool",plug:function(t){return this._add(t),this},unplug:function(t){return this._remove(t),this}}),i(sn,tn,{_onActivation:function(){tn.prototype._onActivation.call(this),this._active&&this._source.onAny(this._$handleMain)},_onDeactivation:function(){tn.prototype._onDeactivation.call(this),this._source.offAny(this._$handleMain),this._hadNoEvSinceDeact=!0},_handleMain:function(t){if(t.type===f){var r=this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value;r||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1}t.type===a&&this._emitError(t.value),t.type===e&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)},_onEmpty:function(){this._mainEnded&&this._emitEnd()},_clear:function(){tn.prototype._clear.call(this),this._source=null,this._lastCurrent=null,this._$handleMain=null}}),i(hn,sn,{_handleMain:function(t){if(t.type===a){var r=this._activating&&this._hadNoEvSinceDeact&&this._lastCurrent===t.value;r||this._add(t.value,this._fn),this._lastCurrent=t.value,this._hadNoEvSinceDeact=!1}t.type===f&&this._emitValue(t.value),t.type===e&&(this._isEmpty()?this._emitEnd():this._mainEnded=!0)}});var pn={_handlePrimaryValue:function(t){this._lastSecondary!==u&&this._lastSecondary&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary!==u&&this._lastSecondary||this._emitEnd()}},on=ln("filterBy",pn),yn=mn("filterBy",pn),wn=function(t,r){return r},En={_handlePrimaryValue:function(t){this._lastSecondary!==u&&this._emitValue(t)},_handleSecondaryEnd:function(){this._lastSecondary===u&&this._emitEnd()}},An=ln("skipUntilBy",En),vn=mn("skipUntilBy",En),Tn={_handleSecondaryValue:function(){this._emitEnd()}},On=ln("takeUntilBy",Tn),Vn=mn("takeUntilBy",Tn),Cn={_init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.flushOnEnd,n=void 0===r||r;this._buff=[],this._flushOnEnd=n},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_onActivation:function(){this._primary.onAny(this._$handlePrimaryAny),this._alive&&null!==this._secondary&&this._secondary.onAny(this._$handleSecondaryAny)},_handlePrimaryValue:function(t){this._buff.push(t)},_handleSecondaryValue:function(){this._flush()},_handleSecondaryEnd:function(){this._flushOnEnd||this._emitEnd()}},$n=ln("bufferBy",Cn),Pn=mn("bufferBy",Cn),jn={_init:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=t.flushOnEnd,n=void 0===r||r,i=t.flushOnChange,u=void 0!==i&&i;this._buff=[],this._flushOnEnd=n,this._flushOnChange=u},_free:function(){this._buff=null},_flush:function(){null!==this._buff&&(this._emitValue(this._buff),this._buff=[])},_handlePrimaryEnd:function(){this._flushOnEnd&&this._flush(),this._emitEnd()},_handlePrimaryValue:function(t){this._buff.push(t),this._lastSecondary===u||this._lastSecondary||this._flush()},_handleSecondaryEnd:function(){this._flushOnEnd||this._lastSecondary!==u&&!this._lastSecondary||this._emitEnd()},_handleSecondaryValue:function(t){this._flushOnChange&&!t&&this._flush(),this._lastSecondary=t}},In=ln("bufferWhileBy",jn),Dn=mn("bufferWhileBy",jn),gn=function(){return!1},bn=function(){return!0},Hn={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleValue:function(t){var r=this._fn,n=r(t);n.convert?this._emitError(n.error):this._emitValue(t)}},qn=R("valuesToErrors",Hn),Mn=F("valuesToErrors",Hn),Bn=function(t){return{convert:!0,error:t}},Wn={_init:function(t){var r=t.fn;this._fn=r},_free:function(){this._fn=null},_handleError:function(t){var r=this._fn,n=r(t);n.convert?this._emitValue(n.value):this._emitError(t)}},Ln=R("errorsToValues",Wn),Gn=F("errorsToValues",Wn),Qn=function(t){return{convert:!0,value:t}},Xn={_handleError:function(t){this._emitError(t),this._emitEnd()}},Jn=R("endOnError",Xn),Un=F("endOnError",Xn);w.prototype.toProperty=function(t){return N(this,t)},w.prototype.changes=function(){return new x(this)},w.prototype.toPromise=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:d(),n=null;return new r(function(r,i){t.onAny(function(t){t.type===e&&null!==n?((n.type===f?r:i)(n.value),n=null):n=t})})}(this,t)},w.prototype.toESObservable=at,w.prototype[ut]=at,w.prototype.map=function(t){return wt(this,t)},w.prototype.filter=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Tt;return new(t._ofSameType(At,vt))(t,{fn:r})}(this,t)},w.prototype.take=function(t){return function(t,r){return new(t._ofSameType(Vt,Ct))(t,{n:r})}(this,t)},w.prototype.takeErrors=function(t){return function(t,r){return new(t._ofSameType(Pt,jt))(t,{n:r})}(this,t)},w.prototype.takeWhile=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bt;return new(t._ofSameType(Dt,gt))(t,{fn:r})}(this,t)},w.prototype.last=function(){return new((t=this)._ofSameType(qt,Mt))(t);var t},w.prototype.skip=function(t){return function(t,r){return new(t._ofSameType(Wt,Lt))(t,{n:r})}(this,t)},w.prototype.skipWhile=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt;return new(t._ofSameType(Qt,Xt))(t,{fn:r})}(this,t)},w.prototype.skipDuplicates=function(t){return Zt(this,t)},w.prototype.diff=function(t,r){return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u;return new(t._ofSameType(Ft,St))(t,{fn:r||Nt,seed:n})}(this,t,r)},w.prototype.scan=function(t,r){return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:u;return new xt(t,{fn:r,seed:n})}(this,t,r)},w.prototype.flatten=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dt;return new kt(t,{fn:r})}(this,t)},w.prototype.delay=function(t){return function(t,r){return new(t._ofSameType(nr,ir))(t,{wait:r})}(this,t)},w.prototype.throttle=function(t,r){return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=n.leading,u=void 0===i||i,e=n.trailing,f=void 0===e||e;return new(t._ofSameType(fr,ar))(t,{wait:r,leading:u,trailing:f})}(this,t,r)},w.prototype.debounce=function(t,r){return function(t,r){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).immediate,i=void 0!==n&&n;return new(t._ofSameType(hr,_r))(t,{wait:r,immediate:i})}(this,t,r)},w.prototype.mapErrors=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pr;return new(t._ofSameType(lr,mr))(t,{fn:r})}(this,t)},w.prototype.filterErrors=function(t){return function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Er;return new(t._ofSameType(yr,wr))(t,{fn:r})}(this,t)},w.prototype.ignoreValues=function(){return new((t=this)._ofSameType(vr,Tr))(t);var t},w.prototype.ignoreErrors=function(){return new((t=this)._ofSameType(Vr,Cr))(t);var t},w.prototype.ignoreEnd=function(){return new((t=this)._ofSameType(Pr,jr))(t);var t},w.prototype.beforeEnd=function(t){return function(t,r){return new(t._ofSameType(Dr,gr))(t,{fn:r})}(this,t)},w.prototype.slidingWindow=function(t,r){return function(t,r){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return new(t._ofSameType(Hr,qr))(t,{min:n,max:r})}(this,t,r)},w.prototype.bufferWhile=function(t,r){return function(t,r){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).flushOnEnd,i=void 0===n||n;return new(t._ofSameType(Br,Wr))(t,{fn:r||Lr,flushOnEnd:i})}(this,t,r)},w.prototype.bufferWithCount=function(t,r){return function(t,r){var n=(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).flushOnEnd,i=void 0===n||n;return new(t._ofSameType(Qr,Xr))(t,{count:r,flushOnEnd:i})}(this,t,r)},w.prototype.bufferWithTimeOrCount=function(t,r,n){return function(t,r,n){var i=(arguments.length>3&&void 0!==arguments[3]?arguments[3]:{}).flushOnEnd,u=void 0===i||i;return new(t._ofSameType(Ur,Yr))(t,{wait:r,count:n,flushOnEnd:u})}(this,t,r,n)},w.prototype.transduce=function(t){return function(t,r){return new(t._ofSameType(zr,Zr))(t,{transducer:r})}(this,t)},w.prototype.withHandler=function(t){return function(t,r){return new(t._ofSameType(Fr,Sr))(t,{fn:r})}(this,t)},w.prototype.thru=function(t){return t(this)},w.prototype.combine=function(t,r){return _t([this,t],r)},w.prototype.zip=function(t,r){return kr([this,t],r)},w.prototype.merge=function(t){return nn([this,t])},w.prototype.concat=function(t){return fn([this,t])};var Yn=function(){return new an};w.prototype.flatMap=function(t){return new sn(this,t).setName(this,"flatMap")},w.prototype.flatMapLatest=function(t){return new sn(this,t,{concurLim:1,drop:"old"}).setName(this,"flatMapLatest")},w.prototype.flatMapFirst=function(t){return new sn(this,t,{concurLim:1}).setName(this,"flatMapFirst")},w.prototype.flatMapConcat=function(t){return new sn(this,t,{queueLim:-1,concurLim:1}).setName(this,"flatMapConcat")},w.prototype.flatMapConcurLimit=function(t,r){return new sn(this,t,{queueLim:-1,concurLim:r}).setName(this,"flatMapConcurLimit")},w.prototype.flatMapErrors=function(t){return new hn(this,t).setName(this,"flatMapErrors")},w.prototype.filterBy=function(t){return n=t,new((r=this)._ofSameType(on,yn))(r,n);var r,n},w.prototype.sampledBy=function(t,r){return function(t,r,n){return _t([r],[t],n?function(t,r){return n(r,t)}:wn).setName(t,"sampledBy")}(this,t,r)},w.prototype.skipUntilBy=function(t){return n=t,new((r=this)._ofSameType(An,vn))(r,n);var r,n},w.prototype.takeUntilBy=function(t){return n=t,new((r=this)._ofSameType(On,Vn))(r,n);var r,n},w.prototype.bufferBy=function(t,r){return function(t,r,n){return new(t._ofSameType($n,Pn))(t,r,n)}(this,t,r)},w.prototype.bufferWhileBy=function(t,r){return function(t,r,n){return new(t._ofSameType(In,Dn))(t,r,n)}(this,t,r)};var Kn=!0;function zn(t){Kn&&console&&"function"==typeof console.warn&&console.warn(t,"\nHere is an Error object for you containing the call stack:",new Error)}w.prototype.awaiting=function(t){return zn("You are using deprecated .awaiting() method, see https://github.com/kefirjs/kefir/issues/145"),n=t,N(Zt(nn([wt(r=this,bn),wt(n,gn)])),gn).setName(r,"awaiting");var r,n},w.prototype.valuesToErrors=function(t){return zn("You are using deprecated .valuesToErrors() method, see https://github.com/kefirjs/kefir/issues/149"),function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bn;return new(t._ofSameType(qn,Mn))(t,{fn:r})}(this,t)},w.prototype.errorsToValues=function(t){return zn("You are using deprecated .errorsToValues() method, see https://github.com/kefirjs/kefir/issues/149"),function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Qn;return new(t._ofSameType(Ln,Gn))(t,{fn:r})}(this,t)},w.prototype.endOnError=function(){return zn("You are using deprecated .endOnError() method, see https://github.com/kefirjs/kefir/issues/150"),new((t=this)._ofSameType(Jn,Un))(t);var t};var Zn={Observable:w,Stream:E,Property:A,never:T,later:C,interval:P,sequentially:I,fromPoll:g,withInterval:q,fromCallback:W,fromNodeCallback:L,fromEvents:X,stream:B,constant:U,constantError:K,fromPromise:k,fromESObservable:et,combine:_t,zip:kr,merge:nn,concat:fn,Pool:an,pool:Yn,repeat:en,staticLand:lt};Zn.Kefir=Zn,r.dissableDeprecationWarnings=function(){Kn=!1},r.Kefir=Zn,r.Observable=w,r.Stream=E,r.Property=A,r.never=T,r.later=C,r.interval=P,r.sequentially=I,r.fromPoll=g,r.withInterval=q,r.fromCallback=W,r.fromNodeCallback=L,r.fromEvents=X,r.stream=B,r.constant=U,r.constantError=K,r.fromPromise=k,r.fromESObservable=et,r.combine=_t,r.zip=kr,r.merge=nn,r.concat=fn,r.Pool=an,r.pool=Yn,r.repeat=en,r.staticLand=lt,r.default=Zn,Object.defineProperty(r,"__esModule",{value:!0})}(n)});(n=i)&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")&&n.default;var u=i.fromEvents,e=r(function(r){!function(){function n(t,r,n,i,u,e){return{tag:t,key:r,attrs:n,children:i,text:u,dom:e,domSize:void 0,state:void 0,_state:void 0,events:void 0,instance:void 0,skip:!1}}n.normalize=function(t){return Array.isArray(t)?n("[",void 0,void 0,n.normalizeChildren(t),void 0,void 0):null!=t&&"object"!=typeof t?n("#",void 0,void 0,!1===t?"":t,void 0,void 0):t},n.normalizeChildren=function(t){for(var r=0;r<t.length;r++)t[r]=n.normalize(t[r]);return t};var i=/(?:(^|#|\.)([^#\.\[\]]+))|(\[(.+?)(?:\s*=\s*("|'|)((?:\\["'\]]|.)*?)\5)?\])/g,u={},e={}.hasOwnProperty;function f(t){for(var r in t)if(e.call(t,r))return!1;return!0}function a(t){var r,a=arguments[1],s=2;if(null==t||"string"!=typeof t&&"function"!=typeof t&&"function"!=typeof t.view)throw Error("The selector must be either a string or a component.");if("string"==typeof t)var h=u[t]||function(t){for(var r,n="div",e=[],f={};r=i.exec(t);){var a=r[1],s=r[2];if(""===a&&""!==s)n=s;else if("#"===a)f.id=s;else if("."===a)e.push(s);else if("["===r[3][0]){var h=r[6];h&&(h=h.replace(/\\(["'])/g,"$1").replace(/\\\\/g,"\\")),"class"===r[4]?e.push(h):f[r[4]]=""===h?h:h||!0}}return e.length>0&&(f.className=e.join(" ")),u[t]={tag:n,attrs:f}}(t);if(null==a?a={}:("object"!=typeof a||null!=a.tag||Array.isArray(a))&&(a={},s=1),arguments.length===s+1)r=arguments[s],Array.isArray(r)||(r=[r]);else for(r=[];s<arguments.length;)r.push(arguments[s++]);var _=n.normalizeChildren(r);return"string"==typeof t?function(t,r,i){var u,a,s=!1,h=r.className||r.class;if(!f(t.attrs)&&!f(r)){var _={};for(var c in r)e.call(r,c)&&(_[c]=r[c]);r=_}for(var c in t.attrs)e.call(t.attrs,c)&&(r[c]=t.attrs[c]);for(var c in void 0!==h&&(void 0!==r.class&&(r.class=void 0,r.className=h),null!=t.attrs.className&&(r.className=t.attrs.className+" "+h)),r)if(e.call(r,c)&&"key"!==c){s=!0;break}return Array.isArray(i)&&1===i.length&&null!=i[0]&&"#"===i[0].tag?a=i[0].children:u=i,n(t.tag,r.key,s?r:void 0,u,a)}(h,a,_):n(t,a.key,a,_)}a.trust=function(t){return null==t&&(t=""),n("<",void 0,void 0,t,void 0,void 0)},a.fragment=function(t,r){return n("[",t.key,t,n.normalizeChildren(r),void 0,void 0)};var s=a;if((h=function(t){if(!(this instanceof h))throw new Error("Promise must be called with `new`");if("function"!=typeof t)throw new TypeError("executor must be a function");var r=this,n=[],i=[],u=s(n,!0),e=s(i,!1),f=r._instance={resolvers:n,rejectors:i},a="function"==typeof setImmediate?setImmediate:setTimeout;function s(t,u){return function s(h){var c;try{if(!u||null==h||"object"!=typeof h&&"function"!=typeof h||"function"!=typeof(c=h.then))a(function(){u||0!==t.length||console.error("Possible unhandled promise rejection:",h);for(var r=0;r<t.length;r++)t[r](h);n.length=0,i.length=0,f.state=u,f.retry=function(){s(h)}});else{if(h===r)throw new TypeError("Promise can't be resolved w/ itself");_(c.bind(h))}}catch(t){e(t)}}}function _(t){var r=0;function n(t){return function(n){r++>0||t(n)}}var i=n(e);try{t(n(u),i)}catch(t){i(t)}}_(t)}).prototype.then=function(t,r){var n,i,u=this._instance;function e(t,r,e,f){r.push(function(r){if("function"!=typeof t)e(r);else try{n(t(r))}catch(t){i&&i(t)}}),"function"==typeof u.retry&&f===u.state&&u.retry()}var f=new h(function(t,r){n=t,i=r});return e(t,u.resolvers,n,!0),e(r,u.rejectors,i,!1),f},h.prototype.catch=function(t){return this.then(null,t)},h.resolve=function(t){return t instanceof h?t:new h(function(r){r(t)})},h.reject=function(t){return new h(function(r,n){n(t)})},h.all=function(t){return new h(function(r,n){var i=t.length,u=0,e=[];if(0===t.length)r([]);else for(var f=0;f<t.length;f++)!function(f){function a(t){u++,e[f]=t,u===i&&r(e)}null==t[f]||"object"!=typeof t[f]&&"function"!=typeof t[f]||"function"!=typeof t[f].then?a(t[f]):t[f].then(a,n)}(f)})},h.race=function(t){return new h(function(r,n){for(var i=0;i<t.length;i++)t[i].then(r,n)})},"undefined"!=typeof window){void 0===window.Promise&&(window.Promise=h);var h=window.Promise}else if(void 0!==t){void 0===t.Promise&&(t.Promise=h);h=t.Promise}var _=function(t){if("[object Object]"!==Object.prototype.toString.call(t))return"";var r=[];for(var n in t)i(n,t[n]);return r.join("&");function i(t,n){if(Array.isArray(n))for(var u=0;u<n.length;u++)i(t+"["+u+"]",n[u]);else if("[object Object]"===Object.prototype.toString.call(n))for(var u in n)i(t+"["+u+"]",n[u]);else r.push(encodeURIComponent(t)+(null!=n&&""!==n?"="+encodeURIComponent(n):""))}},c=new RegExp("^file://","i"),l=function(t,r){var n,i=0;function u(){var t=0;function r(){0==--t&&"function"==typeof n&&n()}return function n(i){var u=i.then;return i.then=function(){t++;var e=u.apply(i,arguments);return e.then(r,function(n){if(r(),0===t)throw n}),n(e)},i}}function e(t,r){if("string"==typeof t){var n=t;null==(t=r||{}).url&&(t.url=n)}return t}function f(t,r){if(null==r)return t;for(var n=t.match(/:[^\/]+/gi)||[],i=0;i<n.length;i++){var u=n[i].slice(1);null!=r[u]&&(t=t.replace(n[i],r[u]))}return t}function a(t,r){var n=_(r);if(""!==n){var i=t.indexOf("?")<0?"?":"&";t+=i+n}return t}function s(t){try{return""!==t?JSON.parse(t):null}catch(r){throw new Error(t)}}function h(t){return t.responseText}function l(t,r){if("function"==typeof t){if(!Array.isArray(r))return new t(r);for(var n=0;n<r.length;n++)r[n]=new t(r[n])}return r}return{request:function(n,i){var _=u();n=e(n,i);var m=new r(function(r,i){null==n.method&&(n.method="GET"),n.method=n.method.toUpperCase();var u="GET"!==n.method&&"TRACE"!==n.method&&("boolean"!=typeof n.useBody||n.useBody);"function"!=typeof n.serialize&&(n.serialize="undefined"!=typeof FormData&&n.data instanceof FormData?function(t){return t}:JSON.stringify),"function"!=typeof n.deserialize&&(n.deserialize=s),"function"!=typeof n.extract&&(n.extract=h),n.url=f(n.url,n.data),u?n.data=n.serialize(n.data):n.url=a(n.url,n.data);var e=new t.XMLHttpRequest,_=!1,m=e.abort;for(var p in e.abort=function(){_=!0,m.call(e)},e.open(n.method,n.url,"boolean"!=typeof n.async||n.async,"string"==typeof n.user?n.user:void 0,"string"==typeof n.password?n.password:void 0),n.serialize!==JSON.stringify||!u||n.headers&&n.headers.hasOwnProperty("Content-Type")||e.setRequestHeader("Content-Type","application/json; charset=utf-8"),n.deserialize!==s||n.headers&&n.headers.hasOwnProperty("Accept")||e.setRequestHeader("Accept","application/json, text/*"),n.withCredentials&&(e.withCredentials=n.withCredentials),n.headers)({}).hasOwnProperty.call(n.headers,p)&&e.setRequestHeader(p,n.headers[p]);"function"==typeof n.config&&(e=n.config(e,n)||e),e.onreadystatechange=function(){if(!_&&4===e.readyState)try{var t=n.extract!==h?n.extract(e,n):n.deserialize(n.extract(e,n));if(e.status>=200&&e.status<300||304===e.status||c.test(n.url))r(l(n.type,t));else{var u=new Error(e.responseText);for(var f in t)u[f]=t[f];i(u)}}catch(t){i(t)}},u&&null!=n.data?e.send(n.data):e.send()});return!0===n.background?m:_(m)},jsonp:function(n,s){var h=u();n=e(n,s);var _=new r(function(r,u){var e=n.callbackName||"_mithril_"+Math.round(1e16*Math.random())+"_"+i++,s=t.document.createElement("script");t[e]=function(i){s.parentNode.removeChild(s),r(l(n.type,i)),delete t[e]},s.onerror=function(){s.parentNode.removeChild(s),u(new Error("JSONP request failed")),delete t[e]},null==n.data&&(n.data={}),n.url=f(n.url,n.data),n.data[n.callbackKey||"callback"]=e,s.src=a(n.url,n.data),t.document.documentElement.appendChild(s)});return!0===n.background?_:h(_)},setCompletionCallback:function(t){n=t}}}(window,h),m=function(t){var r,i=t.document,u=i.createDocumentFragment(),e={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"};function f(t){return t.attrs&&t.attrs.xmlns||e[t.tag]}function a(t,r,n,i,u,e,f){for(var a=n;a<i;a++){var h=r[a];null!=h&&s(t,h,u,f,e)}}function s(t,r,e,c,l){var m=r.tag;if("string"!=typeof m)return function(t,r,n,i,e){if(_(r,n),null!=r.instance){var f=s(t,r.instance,n,i,e);return r.dom=r.instance.dom,r.domSize=null!=r.dom?r.instance.domSize:0,y(t,f,e),f}return r.domSize=0,u}(t,r,e,c,l);switch(r.state={},null!=r.attrs&&C(r.attrs,r,e),m){case"#":return function(t,r,n){return r.dom=i.createTextNode(r.children),y(t,r.dom,n),r.dom}(t,r,l);case"<":return h(t,r,l);case"[":return function(t,r,n,u,e){var f=i.createDocumentFragment();if(null!=r.children){var s=r.children;a(f,s,0,s.length,n,null,u)}return r.dom=f.firstChild,r.domSize=f.childNodes.length,y(t,f,e),f}(t,r,e,c,l);default:return function(t,r,u,e,s){var h=r.tag,_=r.attrs,c=_&&_.is,l=(e=f(r)||e)?c?i.createElementNS(e,h,{is:c}):i.createElementNS(e,h):c?i.createElement(h,{is:c}):i.createElement(h);r.dom=l,null!=_&&function(t,r,n){for(var i in r)T(t,i,null,r[i],n)}(r,_,e);if(y(t,l,s),null!=r.attrs&&null!=r.attrs.contenteditable)w(r);else if(null!=r.text&&(""!==r.text?l.textContent=r.text:r.children=[n("#",void 0,void 0,r.text,void 0,void 0)]),null!=r.children){var m=r.children;a(l,m,0,m.length,u,null,e),function(t){var r=t.attrs;"select"===t.tag&&null!=r&&("value"in r&&T(t,"value",null,r.value,void 0),"selectedIndex"in r&&T(t,"selectedIndex",null,r.selectedIndex,void 0))}(r)}return l}(t,r,e,c,l)}}function h(t,r,n){var u={caption:"table",thead:"table",tbody:"table",tfoot:"table",tr:"tbody",th:"tr",td:"tr",colgroup:"table",col:"colgroup"}[(r.children.match(/^\s*?<(\w+)/im)||[])[1]]||"div",e=i.createElement(u);e.innerHTML=r.children,r.dom=e.firstChild,r.domSize=e.childNodes.length;for(var f,a=i.createDocumentFragment();f=e.firstChild;)a.appendChild(f);return y(t,a,n),a}function _(t,r){var i;if("function"==typeof t.tag.view){if(t.state=Object.create(t.tag),null!=(i=t.state.view).$$reentrantLock$$)return u;i.$$reentrantLock$$=!0}else{if(t.state=void 0,null!=(i=t.tag).$$reentrantLock$$)return u;i.$$reentrantLock$$=!0,t.state=null!=t.tag.prototype&&"function"==typeof t.tag.prototype.view?new t.tag(t):t.tag(t)}if(t._state=t.state,null!=t.attrs&&C(t.attrs,t,r),C(t._state,t,r),t.instance=n.normalize(t._state.view.call(t.state,t)),t.instance===t)throw Error("A view cannot return the vnode it received as argument");i.$$reentrantLock$$=null}function c(t,r,n,i,u,e,f){if(r!==n&&(null!=r||null!=n))if(null==r)a(t,n,0,n.length,u,e,f);else if(null==n)E(r,0,r.length,n);else{if(r.length===n.length){for(var h=!1,_=0;_<n.length;_++)if(null!=n[_]&&null!=r[_]){h=null==n[_].key&&null==r[_].key;break}if(h){for(_=0;_<r.length;_++)r[_]!==n[_]&&(null==r[_]&&null!=n[_]?s(t,n[_],u,f,o(r,_+1,e)):null==n[_]?E(r,_,_+1,n):l(t,r[_],n[_],u,o(r,_+1,e),i,f));return}}if(i=i||function(t,r){if(null!=t.pool&&Math.abs(t.pool.length-r.length)<=Math.abs(t.length-r.length)){var n=t[0]&&t[0].children&&t[0].children.length||0,i=t.pool[0]&&t.pool[0].children&&t.pool[0].children.length||0,u=r[0]&&r[0].children&&r[0].children.length||0;if(Math.abs(i-u)<=Math.abs(n-u))return!0}return!1}(r,n)){var c=r.pool;r=r.concat(r.pool)}for(var w,A=0,v=0,T=r.length-1,O=n.length-1;T>=A&&O>=v;){if((C=r[A])!==($=n[v])||i)if(null==C)A++;else if(null==$)v++;else if(C.key===$.key){var V=null!=c&&A>=r.length-c.length||null==c&&i;v++,l(t,C,$,u,o(r,++A,e),V,f),i&&C.tag===$.tag&&y(t,p(C),e)}else{if((C=r[T])!==$||i)if(null==C)T--;else if(null==$)v++;else{if(C.key!==$.key)break;V=null!=c&&T>=r.length-c.length||null==c&&i;l(t,C,$,u,o(r,T+1,e),V,f),(i||v<O)&&y(t,p(C),o(r,A,e)),T--,v++}else T--,v++}else A++,v++}for(;T>=A&&O>=v;){var C,$;if((C=r[T])!==($=n[O])||i)if(null==C)T--;else if(null==$)O--;else if(C.key===$.key){V=null!=c&&T>=r.length-c.length||null==c&&i;l(t,C,$,u,o(r,T+1,e),V,f),i&&C.tag===$.tag&&y(t,p(C),e),null!=C.dom&&(e=C.dom),T--,O--}else{if(w||(w=m(r,T)),null!=$){var P=w[$.key];if(null!=P){var j=r[P];V=null!=c&&P>=r.length-c.length||null==c&&i;l(t,j,$,u,o(r,T+1,e),i,f),y(t,p(j),e),r[P].skip=!0,null!=j.dom&&(e=j.dom)}else{e=s(t,$,u,f,e)}}O--}else T--,O--;if(O<v)break}a(t,n,v,O+1,u,e,f),E(r,A,T+1,n)}}function l(t,r,i,u,e,a,m){var o=r.tag;if(o===i.tag){if(i.state=r.state,i._state=r._state,i.events=r.events,!a&&function(t,r){var n,i;null!=t.attrs&&"function"==typeof t.attrs.onbeforeupdate&&(n=t.attrs.onbeforeupdate.call(t.state,t,r));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeupdate&&(i=t._state.onbeforeupdate.call(t.state,t,r));if(!(void 0===n&&void 0===i||n||i))return t.dom=r.dom,t.domSize=r.domSize,t.instance=r.instance,!0;return!1}(i,r))return;if("string"==typeof o)switch(null!=i.attrs&&(a?(i.state={},C(i.attrs,i,u)):$(i.attrs,i,u)),o){case"#":!function(t,r){t.children.toString()!==r.children.toString()&&(t.dom.nodeValue=r.children);r.dom=t.dom}(r,i);break;case"<":!function(t,r,n,i){r.children!==n.children?(p(r),h(t,n,i)):(n.dom=r.dom,n.domSize=r.domSize)}(t,r,i,e);break;case"[":!function(t,r,n,i,u,e,f){c(t,r.children,n.children,i,u,e,f);var a=0,s=n.children;if(n.dom=null,null!=s){for(var h=0;h<s.length;h++){var _=s[h];null!=_&&null!=_.dom&&(null==n.dom&&(n.dom=_.dom),a+=_.domSize||1)}1!==a&&(n.domSize=a)}}(t,r,i,a,u,e,m);break;default:!function(t,r,i,u,e){var a=r.dom=t.dom;e=f(r)||e,"textarea"===r.tag&&(null==r.attrs&&(r.attrs={}),null!=r.text&&(r.attrs.value=r.text,r.text=void 0));(function(t,r,n,i){if(null!=n)for(var u in n)T(t,u,r&&r[u],n[u],i);if(null!=r)for(var u in r)null!=n&&u in n||("className"===u&&(u="class"),"o"!==u[0]||"n"!==u[1]||O(u)?"key"!==u&&t.dom.removeAttribute(u):V(t,u,void 0))})(r,t.attrs,r.attrs,e),null!=r.attrs&&null!=r.attrs.contenteditable?w(r):null!=t.text&&null!=r.text&&""!==r.text?t.text.toString()!==r.text.toString()&&(t.dom.firstChild.nodeValue=r.text):(null!=t.text&&(t.children=[n("#",void 0,void 0,t.text,void 0,t.dom.firstChild)]),null!=r.text&&(r.children=[n("#",void 0,void 0,r.text,void 0,void 0)]),c(a,t.children,r.children,i,u,null,e))}(r,i,a,u,m)}else!function(t,r,i,u,e,f,a){if(f)_(i,u);else{if(i.instance=n.normalize(i._state.view.call(i.state,i)),i.instance===i)throw Error("A view cannot return the vnode it received as argument");null!=i.attrs&&$(i.attrs,i,u),$(i._state,i,u)}null!=i.instance?(null==r.instance?s(t,i.instance,u,a,e):l(t,r.instance,i.instance,u,e,f,a),i.dom=i.instance.dom,i.domSize=i.instance.domSize):null!=r.instance?(A(r.instance,null),i.dom=void 0,i.domSize=0):(i.dom=r.dom,i.domSize=r.domSize)}(t,r,i,u,e,a,m)}else A(r,null),s(t,i,u,m,e)}function m(t,r){var n={},i=0;for(i=0;i<r;i++){var u=t[i];if(null!=u){var e=u.key;null!=e&&(n[e]=i)}}return n}function p(t){var r=t.domSize;if(null!=r||null==t.dom){var n=i.createDocumentFragment();if(r>0){for(var u=t.dom;--r;)n.appendChild(u.nextSibling);n.insertBefore(u,n.firstChild)}return n}return t.dom}function o(t,r,n){for(;r<t.length;r++)if(null!=t[r]&&null!=t[r].dom)return t[r].dom;return n}function y(t,r,n){n&&n.parentNode?t.insertBefore(r,n):t.appendChild(r)}function w(t){var r=t.children;if(null!=r&&1===r.length&&"<"===r[0].tag){var n=r[0].children;t.dom.innerHTML!==n&&(t.dom.innerHTML=n)}else if(null!=t.text||null!=r&&0!==r.length)throw new Error("Child node of a contenteditable must be trusted")}function E(t,r,n,i){for(var u=r;u<n;u++){var e=t[u];null!=e&&(e.skip?e.skip=!1:A(e,i))}}function A(t,r){var n,i=1,u=0;t.attrs&&"function"==typeof t.attrs.onbeforeremove&&(null!=(n=t.attrs.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(i++,n.then(e,e)));"string"!=typeof t.tag&&"function"==typeof t._state.onbeforeremove&&(null!=(n=t._state.onbeforeremove.call(t.state,t))&&"function"==typeof n.then&&(i++,n.then(e,e)));function e(){if(++u===i&&(function t(r){r.attrs&&"function"==typeof r.attrs.onremove&&r.attrs.onremove.call(r.state,r);if("string"!=typeof r.tag)"function"==typeof r._state.onremove&&r._state.onremove.call(r.state,r),null!=r.instance&&t(r.instance);else{var n=r.children;if(Array.isArray(n))for(var i=0;i<n.length;i++){var u=n[i];null!=u&&t(u)}}}(t),t.dom)){var n=t.domSize||1;if(n>1)for(var e=t.dom;--n;)v(e.nextSibling);v(t.dom),null==r||null!=t.domSize||null!=(f=t.attrs)&&(f.oncreate||f.onupdate||f.onbeforeremove||f.onremove)||"string"!=typeof t.tag||(r.pool?r.pool.push(t):r.pool=[t])}var f}e()}function v(t){var r=t.parentNode;null!=r&&r.removeChild(t)}function T(t,r,n,u,e){var f=t.dom;if("key"!==r&&"is"!==r&&(n!==u||function(t,r){return"value"===r||"checked"===r||"selectedIndex"===r||"selected"===r&&t.dom===i.activeElement}(t,r)||"object"==typeof u)&&void 0!==u&&!O(r)){var a,s=r.indexOf(":");if(s>-1&&"xlink"===r.substr(0,s))f.setAttributeNS("http://www.w3.org/1999/xlink",r.slice(s+1),u);else if("o"===r[0]&&"n"===r[1]&&"function"==typeof u)V(t,r,u);else if("style"===r)!function(t,r,n){r===n&&(t.style.cssText="",r=null);if(null==n)t.style.cssText="";else if("string"==typeof n)t.style.cssText=n;else{for(var i in"string"==typeof r&&(t.style.cssText=""),n)t.style[i]=n[i];if(null!=r&&"string"!=typeof r)for(var i in r)i in n||(t.style[i]="")}}(f,n,u);else if(r in f&&("href"!==(a=r)&&"list"!==a&&"form"!==a&&"width"!==a&&"height"!==a)&&void 0===e&&!function(t){return t.attrs.is||t.tag.indexOf("-")>-1}(t)){if("value"===r){var h=""+u;if(("input"===t.tag||"textarea"===t.tag)&&t.dom.value===h&&t.dom===i.activeElement)return;if("select"===t.tag)if(null===u){if(-1===t.dom.selectedIndex&&t.dom===i.activeElement)return}else if(null!==n&&t.dom.value===h&&t.dom===i.activeElement)return;if("option"===t.tag&&null!=n&&t.dom.value===h)return}if("input"===t.tag&&"type"===r)return void f.setAttribute(r,u);f[r]=u}else"boolean"==typeof u?u?f.setAttribute(r,""):f.removeAttribute(r):f.setAttribute("className"===r?"class":r,u)}}function O(t){return"oninit"===t||"oncreate"===t||"onupdate"===t||"onremove"===t||"onbeforeremove"===t||"onbeforeupdate"===t}function V(t,n,i){var u=t.dom,e="function"!=typeof r?i:function(t){var n=i.call(u,t);return r.call(u,t),n};if(n in u)u[n]="function"==typeof i?e:null;else{var f=n.slice(2);if(void 0===t.events&&(t.events={}),t.events[n]===e)return;null!=t.events[n]&&u.removeEventListener(f,t.events[n],!1),"function"==typeof i&&(t.events[n]=e,u.addEventListener(f,t.events[n],!1))}}function C(t,r,n){"function"==typeof t.oninit&&t.oninit.call(r.state,r),"function"==typeof t.oncreate&&n.push(t.oncreate.bind(r.state,r))}function $(t,r,n){"function"==typeof t.onupdate&&n.push(t.onupdate.bind(r.state,r))}return{render:function(t,r){if(!t)throw new Error("Ensure the DOM element being passed to m.route/m.mount/m.render is not undefined.");var u=[],e=i.activeElement,f=t.namespaceURI;null==t.vnodes&&(t.textContent=""),Array.isArray(r)||(r=[r]),c(t,t.vnodes,n.normalizeChildren(r),!1,u,null,"http://www.w3.org/1999/xhtml"===f?void 0:f),t.vnodes=r,null!=e&&i.activeElement!==e&&e.focus();for(var a=0;a<u.length;a++)u[a]()},setEventCallback:function(t){return r=t}}};var p=function(t){var r=m(t);r.setEventCallback(function(t){!1===t.redraw?t.redraw=void 0:u()});var n=[];function i(t){var r=n.indexOf(t);r>-1&&n.splice(r,2)}function u(){for(var t=1;t<n.length;t+=2)n[t]()}return{subscribe:function(t,r){i(t),n.push(t,function(t){var r=0,n=null,i="function"==typeof requestAnimationFrame?requestAnimationFrame:setTimeout;return function(){var u=Date.now();0===r||u-r>=16?(r=u,t()):null===n&&(n=i(function(){n=null,t(),r=Date.now()},16-(u-r)))}}(r))},unsubscribe:i,redraw:u,render:r.render}}(window);l.setCompletionCallback(p.redraw);var o;s.mount=(o=p,function(t,r){if(null===r)return o.render(t,[]),void o.unsubscribe(t);if(null==r.view&&"function"!=typeof r)throw new Error("m.mount(element, component) expects a component, not a vnode");o.subscribe(t,function(){o.render(t,n(r))}),o.redraw()});var y=h,w=function(t){if(""===t||null==t)return{};"?"===t.charAt(0)&&(t=t.slice(1));for(var r=t.split("&"),n={},i={},u=0;u<r.length;u++){var e=r[u].split("="),f=decodeURIComponent(e[0]),a=2===e.length?decodeURIComponent(e[1]):"";"true"===a?a=!0:"false"===a&&(a=!1);var s=f.split(/\]\[?|\[/),h=n;f.indexOf("[")>-1&&s.pop();for(var _=0;_<s.length;_++){var c=s[_],l=s[_+1],m=""==l||!isNaN(parseInt(l,10)),p=_===s.length-1;if(""===c)null==i[f=s.slice(0,_).join()]&&(i[f]=0),c=i[f]++;null==h[c]&&(h[c]=p?a:m?[]:{}),h=h[c]}}return n},E=function(t){var r,n="function"==typeof t.history.pushState,i="function"==typeof setImmediate?setImmediate:setTimeout;function u(r){var n=t.location[r].replace(/(?:%[a-f89][a-f0-9])+/gim,decodeURIComponent);return"pathname"===r&&"/"!==n[0]&&(n="/"+n),n}function e(t,r,n){var i=t.indexOf("?"),u=t.indexOf("#"),e=i>-1?i:u>-1?u:t.length;if(i>-1){var f=u>-1?u:t.length,a=w(t.slice(i+1,f));for(var s in a)r[s]=a[s]}if(u>-1){var h=w(t.slice(u+1));for(var s in h)n[s]=h[s]}return t.slice(0,e)}var f={prefix:"#!",getPath:function(){switch(f.prefix.charAt(0)){case"#":return u("hash").slice(f.prefix.length);case"?":return u("search").slice(f.prefix.length)+u("hash");default:return u("pathname").slice(f.prefix.length)+u("search")+u("hash")}},setPath:function(r,i,u){var a={},s={};if(r=e(r,a,s),null!=i){for(var h in i)a[h]=i[h];r=r.replace(/:([^\/]+)/g,function(t,r){return delete a[r],i[r]})}var c=_(a);c&&(r+="?"+c);var l=_(s);if(l&&(r+="#"+l),n){var m=u?u.state:null,p=u?u.title:null;t.onpopstate(),u&&u.replace?t.history.replaceState(m,p,f.prefix+r):t.history.pushState(m,p,f.prefix+r)}else t.location.href=f.prefix+r}};return f.defineRoutes=function(u,a,s){function h(){var r=f.getPath(),n={},i=e(r,n,n),h=t.history.state;if(null!=h)for(var _ in h)n[_]=h[_];for(var c in u){var l=new RegExp("^"+c.replace(/:[^\/]+?\.{3}/g,"(.*?)").replace(/:[^\/]+/g,"([^\\/]+)")+"/?$");if(l.test(i))return void i.replace(l,function(){for(var t=c.match(/:[^\/]+/g)||[],i=[].slice.call(arguments,1,-2),e=0;e<t.length;e++)n[t[e].replace(/:|\./g,"")]=decodeURIComponent(i[e]);a(u[c],n,r,c)})}s(r,n)}var _;n?t.onpopstate=(_=h,function(){null==r&&(r=i(function(){r=null,_()}))}):"#"===f.prefix.charAt(0)&&(t.onhashchange=h),h()},f};s.route=function(t,r){var i,u,e,f,a,s=E(t),h=function(t,h,_){if(null==t)throw new Error("Ensure the DOM element that was passed to `m.route` is not undefined");var c=function(){null!=i&&r.render(t,i(n(u,e.key,e)))},l=function(t){if(t===h)throw new Error("Could not resolve default route "+h);s.setPath(h,null,{replace:!0})};s.defineRoutes(_,function(t,r,n){var s=a=function(t,h){s===a&&(u=null==h||"function"!=typeof h.view&&"function"!=typeof h?"div":h,e=r,f=n,a=null,i=(t.render||function(t){return t}).bind(t),c())};t.view||"function"==typeof t?s({},t):t.onmatch?y.resolve(t.onmatch(r,n)).then(function(r){s(t,r)},l):s(t,"div")},l),r.subscribe(t,c)};return h.set=function(t,r,n){null!=a&&((n=n||{}).replace=!0),a=null,s.setPath(t,r,n)},h.get=function(){return f},h.prefix=function(t){s.prefix=t},h.link=function(t){t.dom.setAttribute("href",s.prefix+t.attrs.href),t.dom.onclick=function(t){if(!(t.ctrlKey||t.metaKey||t.shiftKey||2===t.which)){t.preventDefault(),t.redraw=!1;var r=this.getAttribute("href");0===r.indexOf(s.prefix)&&(r=r.slice(s.prefix.length)),h.set(r,void 0,void 0)}}},h.param=function(t){return void 0!==e&&void 0!==t?e[t]:e},h}(window,p),s.withAttr=function(t,r,n){return function(i){r.call(n||this,t in i.currentTarget?i.currentTarget[t]:i.currentTarget.getAttribute(t))}};var A=m(window);s.render=A.render,s.redraw=p.redraw,s.request=l.request,s.jsonp=l.jsonp,s.parseQueryString=w,s.buildQueryString=_,s.version="1.1.6",s.vnode=n,r.exports=s}()}),f=e.route;function a(t){return null!=t&&"object"==typeof t&&!0===t["@@functional/placeholder"]}function s(t){return function r(n){return 0===arguments.length||a(n)?r:t.apply(this,arguments)}}function h(t){return function r(n,i){switch(arguments.length){case 0:return r;case 1:return a(n)?r:s(function(r){return t(n,r)});default:return a(n)&&a(i)?r:a(n)?s(function(r){return t(r,i)}):a(i)?s(function(r){return t(n,r)}):t(n,i)}}}function _(t,r){switch(t){case 0:return function(){return r.apply(this,arguments)};case 1:return function(t){return r.apply(this,arguments)};case 2:return function(t,n){return r.apply(this,arguments)};case 3:return function(t,n,i){return r.apply(this,arguments)};case 4:return function(t,n,i,u){return r.apply(this,arguments)};case 5:return function(t,n,i,u,e){return r.apply(this,arguments)};case 6:return function(t,n,i,u,e,f){return r.apply(this,arguments)};case 7:return function(t,n,i,u,e,f,a){return r.apply(this,arguments)};case 8:return function(t,n,i,u,e,f,a,s){return r.apply(this,arguments)};case 9:return function(t,n,i,u,e,f,a,s,h){return r.apply(this,arguments)};case 10:return function(t,n,i,u,e,f,a,s,h,_){return r.apply(this,arguments)};default:throw new Error("First argument to _arity must be a non-negative integer no greater than ten")}}function c(t,r,n){return function(){for(var i=[],u=0,e=t,f=0;f<r.length||u<arguments.length;){var s;f<r.length&&(!a(r[f])||u>=arguments.length)?s=r[f]:(s=arguments[u],u+=1),i[f]=s,a(s)||(e-=1),f+=1}return e<=0?n.apply(this,i):_(e,c(t,i,n))}}var l=h(function(t,r){return 1===t?s(r):_(t,c(t,[],r))});function m(t){return function r(n,i,u){switch(arguments.length){case 0:return r;case 1:return a(n)?r:h(function(r,i){return t(n,r,i)});case 2:return a(n)&&a(i)?r:a(n)?h(function(r,n){return t(r,i,n)}):a(i)?h(function(r,i){return t(n,r,i)}):s(function(r){return t(n,i,r)});default:return a(n)&&a(i)&&a(u)?r:a(n)&&a(i)?h(function(r,n){return t(r,n,u)}):a(n)&&a(u)?h(function(r,n){return t(r,i,n)}):a(i)&&a(u)?h(function(r,i){return t(n,r,i)}):a(n)?s(function(r){return t(r,i,u)}):a(i)?s(function(r){return t(n,r,u)}):a(u)?s(function(r){return t(n,i,r)}):t(n,i,u)}}}var p=Array.isArray||function(t){return null!=t&&t.length>=0&&"[object Array]"===Object.prototype.toString.call(t)};function o(t,r,n){return function(){if(0===arguments.length)return n();var i=Array.prototype.slice.call(arguments,0),u=i.pop();if(!p(u)){for(var e=0;e<t.length;){if("function"==typeof u[t[e]])return u[t[e]].apply(u,i);e+=1}if(function(t){return null!=t&&"function"==typeof t["@@transducer/step"]}(u))return r.apply(null,i)(u)}return n.apply(this,arguments)}}var y={init:function(){return this.xf["@@transducer/init"]()},result:function(t){return this.xf["@@transducer/result"](t)}};function w(t,r){for(var n=0,i=r.length,u=Array(i);n<i;)u[n]=t(r[n]),n+=1;return u}function E(t){return"[object String]"===Object.prototype.toString.call(t)}var A=s(function(t){return!!p(t)||!!t&&("object"==typeof t&&(!E(t)&&(1===t.nodeType?!!t.length:0===t.length||t.length>0&&(t.hasOwnProperty(0)&&t.hasOwnProperty(t.length-1)))))}),v=function(){function t(t){this.f=t}return t.prototype["@@transducer/init"]=function(){throw new Error("init not implemented on XWrap")},t.prototype["@@transducer/result"]=function(t){return t},t.prototype["@@transducer/step"]=function(t,r){return this.f(t,r)},t}();function T(t){return new v(t)}var O=h(function(t,r){return _(t.length,function(){return t.apply(r,arguments)})});function V(t,r,n){for(var i=n.next();!i.done;){if((r=t["@@transducer/step"](r,i.value))&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}i=n.next()}return t["@@transducer/result"](r)}function C(t,r,n,i){return t["@@transducer/result"](n[i](O(t["@@transducer/step"],t),r))}var $="undefined"!=typeof Symbol?Symbol.iterator:"@@iterator";function P(t,r,n){if("function"==typeof t&&(t=T(t)),A(n))return function(t,r,n){for(var i=0,u=n.length;i<u;){if((r=t["@@transducer/step"](r,n[i]))&&r["@@transducer/reduced"]){r=r["@@transducer/value"];break}i+=1}return t["@@transducer/result"](r)}(t,r,n);if("function"==typeof n["fantasy-land/reduce"])return C(t,r,n,"fantasy-land/reduce");if(null!=n[$])return V(t,r,n[$]());if("function"==typeof n.next)return V(t,r,n);if("function"==typeof n.reduce)return C(t,r,n,"reduce");throw new TypeError("reduce: list must be array or iterable")}var j=function(){function t(t,r){this.xf=r,this.f=t}return t.prototype["@@transducer/init"]=y.init,t.prototype["@@transducer/result"]=y.result,t.prototype["@@transducer/step"]=function(t,r){return this.xf["@@transducer/step"](t,this.f(r))},t}(),I=h(function(t,r){return new j(t,r)});function D(t,r){return Object.prototype.hasOwnProperty.call(r,t)}var g=Object.prototype.toString,b=function(){return"[object Arguments]"===g.call(arguments)?function(t){return"[object Arguments]"===g.call(t)}:function(t){return D("callee",t)}}(),H=!{toString:null}.propertyIsEnumerable("toString"),q=["constructor","valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],M=function(){return arguments.propertyIsEnumerable("length")}(),B=function(t,r){for(var n=0;n<t.length;){if(t[n]===r)return!0;n+=1}return!1},W="function"!=typeof Object.keys||M?s(function(t){if(Object(t)!==t)return[];var r,n,i=[],u=M&&b(t);for(r in t)!D(r,t)||u&&"length"===r||(i[i.length]=r);if(H)for(n=q.length-1;n>=0;)D(r=q[n],t)&&!B(i,r)&&(i[i.length]=r),n-=1;return i}):s(function(t){return Object(t)!==t?[]:Object.keys(t)}),L=h(o(["fantasy-land/map","map"],I,function(t,r){switch(Object.prototype.toString.call(r)){case"[object Function]":return l(r.length,function(){return t.call(this,r.apply(this,arguments))});case"[object Object]":return P(function(n,i){return n[i]=t(r[i]),n},{},W(r));default:return w(t,r)}})),G=m(P);function Q(t,r){return function(){return r.call(this,t.apply(this,arguments))}}function X(t,r){return function(){var n=arguments.length;if(0===n)return r();var i=arguments[n-1];return p(i)||"function"!=typeof i[t]?r.apply(this,arguments):i[t].apply(i,Array.prototype.slice.call(arguments,0,n-1))}}var J=m(X("slice",function(t,r,n){return Array.prototype.slice.call(n,t,r)})),U=s(X("tail",J(1,1/0)));var Y=s(function(t){return E(t)?t.split("").reverse().join(""):Array.prototype.slice.call(t,0).reverse()});function K(){if(0===arguments.length)throw new Error("compose requires at least one argument");return function(){if(0===arguments.length)throw new Error("pipe requires at least one argument");return _(arguments[0].length,G(Q,arguments[0],U(arguments)))}.apply(this,Y(arguments))}"function"==typeof Object.is&&Object.is;var z=function(t){return(t<10?"0":"")+t};Date.prototype.toISOString;var Z,R="\t\n\v\f\r \u2028\u2029\ufeff",F=(s("function"==typeof String.prototype.trim&&!R.trim()&&"".trim()?function(t){return t.trim()}:function(t){var r=new RegExp("^["+R+"]["+R+"]*"),n=new RegExp("["+R+"]["+R+"]*$");return t.replace(r,"").replace(n,"")}),function(t){return JSON.parse(JSON.stringify(t))});!function(t){t.STR="Strength",t.BOD="Body",t.RFL="Reflexes",t.DEX="Dexterity",t.INT="Intelligence",t.WIL="Willpower",t.CHA="Charisma",t.EDG="Edge"}(Z||(Z={}));var S,N=function(t){var r=new Map;if(t)r.set(Z.STR,F(t.get(Z.STR))),r.set(Z.BOD,F(t.get(Z.BOD))),r.set(Z.RFL,F(t.get(Z.RFL))),r.set(Z.DEX,F(t.get(Z.DEX))),r.set(Z.INT,F(t.get(Z.INT))),r.set(Z.WIL,F(t.get(Z.WIL))),r.set(Z.CHA,F(t.get(Z.CHA))),r.set(Z.EDG,F(t.get(Z.EDG)));else{var n=x();r.set(Z.STR,n),r.set(Z.BOD,n),r.set(Z.RFL,n),r.set(Z.DEX,n),r.set(Z.INT,n),r.set(Z.WIL,n),r.set(Z.CHA,n),r.set(Z.EDG,n)}return r},x=function(){return{score:0,link:k(0),xp:0}},k=function(t){if(0===t)return-4;if(1===t)return-2;if(t>=2&&t<=3)return-1;if(t>=4&&t<=6)return 0;if(t>=7&&t<=9)return 1;if(10===t)return 2;var r=Math.floor(t/3);return r>5?5:r},d=[20,30,50,80,120,170,230,300,380,470,570],tt=L(function(t){return Math.floor(.9*t)},d);L(function(t){return Math.floor(1.1*t)},d);!function(t){t.FAST="Fast",t.STANDARD="Standard",t.SLOW="Slow"}(S||(S={}));N();var rt,nt,it=document.body,ut=function(t){return t.currentTarget.value},et={routes:rt=[{name:"root",path:"/"},{name:"secondary",path:"/foo"}],defaultRoute:rt[0].path},ft={routing:{routes:et.routes.slice(),defaultRoute:et.defaultRoute,routeName:et.defaultRoute,params:void 0},value:20,text:""};!function(t){t.TEMP_INCREASE="temp:increase",t.TEXT_CHANGE="text:change",t.ROUTE_CHANGE="route:change"}(nt||(nt={}));var at,st=function(t){return function(r){var n=new CustomEvent("user:event",{detail:{name:t,value:r}});document.body.dispatchEvent(n)}},ht=st(nt.TEMP_INCREASE),_t=st(nt.TEXT_CHANGE),ct=st(nt.ROUTE_CHANGE),lt={view:function(t){var r=t.attrs;return e("nav",{style:"margin-bottom: 10px"},L(function(t){return e("a",{href:t.path,oncreate:f.link,style:"margin: 0 5px"},t.name)},r.routes))}},mt={view:function(t){var r,n=t.attrs;return e("#main",[e("span",{style:"display: block"},"Temp: "+n.value),e("span",{style:"display: block"},"Text: "+n.text),e("button",{onclick:function(){ht(1)},style:"display: block"},"increase temp"),e("input",{type:"text",style:"display: block",placeholder:"enter something",onkeyup:(r=_t,K(r,ut))})])}},pt={view:function(t){return e("#alt",[e("h1","this is the alternate page"),L(function(t){return e("p",t)},tt)])}},ot=function(t){switch(t.routing.routeName){case"/":return e(mt,t);default:return e(pt,t)}},yt={view:function(t){var r=t.attrs;return e("#root",[e(lt,r.routing),ot(r)])}},wt=u(it,"user:event").scan(function(t,r){var n=r.detail;switch(n.name){case nt.TEMP_INCREASE:return t.value+=n.value,t;case nt.TEXT_CHANGE:return t.text=n.value,t;case nt.ROUTE_CHANGE:return t.routing.routeName=n.value.routeName,t.routing.defaultRoute=n.value.params,t;default:return t}},ft),Et=(at=ft).routing.routes.reduce(function(t,r){return t[r.path]={onmatch:function(t,n){at.routing.routeName!==r.path&&ct({routeName:r.path,params:t})},render:function(){return e(yt,at)}},t},{});wt.onValue(function(t){f(it,t.routing.defaultRoute,Et)})}();
//# sourceMappingURL=index.js.map
